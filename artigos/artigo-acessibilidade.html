<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Um Guia Completo de Acessibilidade Web para Devs - Thiago Ramos</title>
    
    <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/International_Symbol_of_Access.svg/1024px-International_Symbol_of_Access.svg.png" type="image/png">

    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg {
            background-color: #0a0a0a;
            background-image: radial-gradient(at 27% 37%, hsla(215, 98%, 61%, 0.1) 0px, transparent 50%), 
                              radial-gradient(at 97% 21%, hsla(125, 98%, 72%, 0.1) 0px, transparent 50%), 
                              radial-gradient(at 52% 99%, hsla(355, 98%, 61%, 0.1) 0px, transparent 50%);
        }
        /* Estilo para o link "Pular para o conteúdo" */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #34d399;
            color: white;
            padding: 8px;
            z-index: 100;
            transition: top 0.3s;
        }
        .skip-link:focus {
            top: 0;
        }
        
        /* Estilos para o botão "Voltar ao Topo" */
        #toTopBtn {
            display: none; /* Oculto por padrão */
            position: fixed;
            bottom: 20px;
            right: 30px;
            z-index: 99;
            border: none;
            outline: none;
            cursor: pointer;
            transition: opacity 0.3s, visibility 0.3s;
        }
</style>
</head>
<body class="bg-gray-900 text-gray-300 gradient-bg">
    <style>
        body.immersion-mode.gradient-bg {
            background-color: #0a0614;
            background-image:
                radial-gradient(at 20% 20%, rgba(217,70,239,0.12) 0px, transparent 50%),
                radial-gradient(at 80% 30%, rgba(59,130,246,0.12) 0px, transparent 50%),
                radial-gradient(at 50% 90%, rgba(236,72,153,0.10) 0px, transparent 50%),
                radial-gradient(at 10% 80%, rgba(34,197,94,0.06) 0px, transparent 50%);
            transition: background 800ms ease;
        }
        body.immersion-mode header { background: rgba(49, 10, 70, 0.45); border-bottom: 1px solid rgba(217, 70, 239, 0.18); }
    </style>

    <a href="#main-content" class="skip-link">Pular para o conteúdo principal</a>

    <header class="py-6">
        <div class="container mx-auto px-6 text-center">
            <a href="../index.html#artigos" class="text-cyan-400 hover:text-cyan-300 transition-colors font-semibold">
                &larr; Voltar para todos os artigos
            </a>
            <div class="mt-4">
                <button id="immersion-toggle" aria-pressed="false" class="inline-flex items-center text-sm font-semibold px-3 py-2 rounded-lg bg-fuchsia-600 hover:bg-fuchsia-700 text-white transition-transform transform hover:scale-105" aria-label="Ativar modo de imersão (visual + áudio)">
                    <i data-lucide="waves" class="w-4 h-4 mr-2"></i>
                    Imersão
                </button>
            </div>
        </div>
    </header>

    <main id="main-content" class="container mx-auto px-6 py-12">
        <article class="max-w-3xl mx-auto">
            <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-4">
                Guia Prático de Acessibilidade Web que Todo Dev Deveria Dominar
            </h1>

            <div class="text-gray-500 mb-8">
                <span>Publicado por Thiago Ramos em 10 de Julho, 2025</span>
            </div>

            <div class="my-8 text-center">
                <a href="assets/artigo-completo-acessibilidade.pdf" 
                   download="Guia-Acessibilidade-Web-Thiago-Ramos.pdf"
                   class="inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-cyan-600 hover:bg-cyan-700 transition-colors"
                   aria-label="Baixar o artigo completo sobre acessibilidade em formato PDF">
                    <i data-lucide="download-cloud" class="w-5 h-5 mr-3"></i>
                    Baixar Guia Completo em PDF
                </a>
            </div>
            <img src="https://placehold.co/1200x600/111827/6366f1?text=Acessibilidade" alt="Banner do artigo sobre Acessibilidade Web" class="w-full rounded-lg mb-8">

            <div class="prose prose-invert prose-lg max-w-none 
                        prose-headings:text-white prose-a:text-cyan-400 prose-strong:text-white
                        prose-blockquote:border-l-cyan-500 prose-blockquote:text-gray-400">
                
                <p>Acessibilidade (muitas vezes abreviada como <strong>a11y</strong>, onde "11" representa as 11 letras entre 'a' e 'y') é a prática de garantir que seus sites e aplicações possam ser usados por todas as pessoas, independentemente de suas habilidades, deficiências ou do contexto em que se encontram. Longe de ser um "extra" ou um item de checklist, a acessibilidade é um pilar da engenharia de software de qualidade. Um site acessível não apenas atende a um público mais amplo (incluindo pessoas com deficiências visuais, auditivas, motoras ou cognitivas), mas também melhora o SEO, a usabilidade geral e reflete um desenvolvimento ético e profissional. Vamos aprofundar em 5 áreas cruciais.</p>

                <h2>1. HTML Semântico: A Fundação de Tudo</h2>
                <p>A semântica é a base. Antes de qualquer framework ou folha de estilo, a estrutura do seu HTML dita como o conteúdo é interpretado por navegadores e tecnologias assistivas (TAs), como leitores de tela. Usar a tag certa para o trabalho certo cria um "mapa" claro e navegável do seu site.</p>
                <p>Pense em um leitor de tela. Ele não "vê" o layout, ele navega pelos elementos do DOM. Tags como <code>&lt;header&gt;</code>, <code>&lt;nav&gt;</code>, <code>&lt;main&gt;</code>, e <code>&lt;footer&gt;</code> criam "landmarks" (pontos de referência) que permitem ao usuário pular diretamente para a navegação ou para o conteúdo principal com um único atalho. A alternativa? Ter que ouvir todo o topo da página repetidamente a cada navegação.</p>
                
                <h4>Hierarquia de Títulos é Inegociável</h4>
                <p>Títulos (<code>&lt;h1&gt;</code> a <code>&lt;h6&gt;</code>) formam o esqueleto do seu conteúdo. Leitores de tela usam essa hierarquia para apresentar um resumo da página e permitir que o usuário salte entre seções. As regras são simples:</p>
                <ul>
                    <li>Use <strong>apenas um <code>&lt;h1&gt;</code></strong> por página, representando o título principal.</li>
                    <li><strong>Não pule níveis</strong> de cabeçalho (ex: de <code>&lt;h2&gt;</code> para <code>&lt;h4&gt;</code>). Isso quebra a estrutura lógica.</li>
                    <li>Não escolha títulos pelo seu tamanho visual. Use CSS para isso. Use as tags pela sua importância estrutural.</li>
                </ul>

                <h4>Exemplo: De "Div-ite" para Semântica Rica</h4>
                <p><strong>ANTES (Não semântico e confuso):</strong></p>
                <pre><code class="language-html">&lt;div class="header"&gt;
  &lt;span class="logo"&gt;Meu Site&lt;/span&gt;
  &lt;div class="menu"&gt;...&lt;/div&gt;
&lt;/div&gt;
&lt;div class="main"&gt;
  &lt;div class="title"&gt;Artigo Principal&lt;/div&gt;
  &lt;div class="post-content"&gt;...&lt;/div&gt;
&lt;/div&gt;</code></pre>

                <p><strong>DEPOIS (Semântico e acessível):</strong></p>
                <pre><code class="language-html">&lt;header&gt;
  &lt;a href="/"&gt;Meu Site&lt;/a&gt;
  &lt;nav aria-label="Navegação principal"&gt;...&lt;/nav&gt;
&lt;/header&gt;
&lt;main&gt;
  &lt;article&gt;
    &lt;h1&gt;Artigo Principal&lt;/h1&gt;
    &lt;p&gt;...&lt;/p&gt;
  &lt;/article&gt;
&lt;/main&gt;
&lt;footer&gt;...&lt;/footer&gt;</code></pre>
                <blockquote>Sempre se pergunte: "Qual é o propósito deste bloco?". Se a resposta for "cabeçalho", "artigo", ou "seção", use a tag correspondente. Use <code>&lt;section&gt;</code> para agrupar conteúdos temáticos e <code>&lt;article&gt;</code> para blocos autossuficientes e distribuíveis. Reserve as <code>&lt;div&gt;</code>s para agrupamentos puramente visuais.</blockquote>

                <h2>2. Imagens Acessíveis: O Poder do Atributo `alt`</h2>
                <p>O texto alternativo descreve o conteúdo e a função de uma imagem para quem não pode vê-la. Isso inclui usuários de leitores de tela e também situações em que a imagem não carrega. O contexto é tudo ao escrever um bom texto `alt`.</p>
                <ul>
                    <li><strong>Imagens Informativas:</strong> Descreva o que a imagem mostra. Seja conciso, mas preciso. Evite começar com "Imagem de..." ou "Foto de...", pois o leitor de tela já anuncia que é uma imagem.</li>
                    <li><strong>Imagens Funcionais (dentro de links):</strong> O `alt` deve descrever a <em>ação</em> ou o destino do link, não a imagem em si.</li>
                    <li><strong>Imagens Decorativas:</strong> Se uma imagem não adiciona informação e é puramente visual, use um `alt` vazio (<code>alt=""</code>). Isso instrui os leitores de tela a ignorá-la. Deixar o atributo `alt` de fora é um erro, pois alguns leitores podem tentar ler o nome do arquivo.</li>
                    <li><strong>Imagens Complexas (Gráficos, Infográficos):</strong> O `alt` deve fornecer um resumo. O conteúdo completo deve estar no texto próximo à imagem ou em um link para uma descrição detalhada. Use <code>&lt;figure&gt;</code> e <code>&lt;figcaption&gt;</code> para associar a imagem a uma legenda visível.</li>
                </ul>
                <pre><code class="language-html">&lt;!-- Imagem informativa --&gt;
&lt;img src="equipe.jpg" alt="A equipe de desenvolvimento sorrindo em frente ao escritório."&gt;

&lt;!-- Imagem funcional --&gt;
&lt;a href="/configuracoes"&gt;
  &lt;img src="engrenagem.svg" alt="Acessar configurações da conta."&gt;
&lt;/a&gt;

&lt;!-- Imagem complexa com legenda --&gt;
&lt;figure&gt;
  &lt;img src="grafico-vendas.png" alt="Gráfico de barras mostrando aumento de vendas no último trimestre."&gt;
  &lt;figcaption&gt;Fig. 1: Crescimento de 20% nas vendas de Q3, impulsionado pelo produto X.&lt;/figcaption&gt;
&lt;/figure&gt;
</code></pre>

                <h2>3. Contraste de Cores: Mais que Apenas Estética</h2>
                <p>Textos com baixo contraste são um dos problemas de acessibilidade mais comuns. Eles afetam pessoas com baixa visão, daltonismo e até mesmo usuários em situações adversas, como usar um celular sob a luz do sol. As diretrizes do WCAG definem níveis de conformidade:</p>
                <ul>
                    <li><strong>Nível AA (Mínimo):</strong> Taxa de contraste de <strong>4.5:1</strong> para texto normal e <strong>3:1</strong> para texto grande (acima de 18pt ou 14pt em negrito).</li>
                    <li><strong>Nível AAA (Avançado):</strong> Taxa de <strong>7:1</strong> para texto normal e <strong>4.5:1</strong> para texto grande.</li>
                </ul>
                <p>Você não precisa ser um expert em cálculo de cores. Use as ferramentas de desenvolvedor do seu navegador (no inspetor de elementos, o seletor de cores geralmente mostra a taxa de contraste) ou extensões como o "axe DevTools".</p>
                <h4>Não confie apenas na cor</h4>
                <p>Uma regra fundamental é: a cor não deve ser o único meio de transmitir informação. Se você usa vermelho para indicar um erro em um formulário, adicione também um ícone e um texto explicativo. Se um gráfico usa cores para diferenciar as séries, use também padrões (listras, pontos) ou legendas claras.</p>

                <h2>4. Formulários Inclusivos: A Porta de Entrada da Interação</h2>
                <p>Formulários mal construídos são uma barreira intransponível para muitos. A regra de ouro é: <strong>associe cada controle de formulário a uma <code>&lt;label&gt;</code> visível.</strong> Clicar na label deve focar no campo correspondente.</p>
                
                <h4>Feedback de Erro Acessível</h4>
                <p>Quando um erro de validação ocorre, o feedback precisa ser robusto.</p>
                <ol>
                    <li>Identifique o campo problemático programaticamente usando <code>aria-invalid="true"</code>.</li>
                    <li>Forneça uma mensagem de erro clara e visível.</li>
                    <li>Associe a mensagem de erro ao campo usando <code>aria-describedby</code>. Isso faz com que o leitor de tela leia a mensagem de erro quando o usuário foca no campo.</li>
                </ol>

                <pre><code class="language-html">&lt;label for="email"&gt;Seu e-mail:&lt;/label&gt;
&lt;input type="email" id="email" name="email"
       aria-invalid="true" 
       aria-describedby="email-error"&gt;
&lt;span id="email-error" class="error-message"&gt;
  Por favor, insira um formato de e-mail válido.
&lt;/span&gt;</code></pre>
                
                <blockquote><strong>Cuidado com Placeholders:</strong> O atributo <code>placeholder</code> não substitui a <code>&lt;label&gt;</code>. Placeholders têm baixo contraste, desaparecem quando o usuário começa a digitar (sobrecarregando a memória de curto prazo) e não são suportados por todas as TAs. Use-os apenas como dicas suplementares, nunca como a única instrução.</blockquote>

                <h2>5. Navegação por Teclado e Foco Visível: Liberdade do Mouse</h2>
                <p>Muitos usuários com deficiências motoras, ou mesmo "power users", dependem do teclado para navegar. Garanta que todos os elementos interativos (links, botões, campos de formulário) possam ser alcançados e ativados com a tecla `Tab`. A ordem da tabulação deve ser lógica e previsível, o que geralmente é um benefício gratuito do uso de HTML semântico.</p>
                <p>O mais importante é que o usuário <strong>sempre saiba onde está</strong>. O indicador de foco (geralmente um anel azul ou preto ao redor do elemento) é essencial. Nunca, jamais, o remova globalmente com `outline: none;` sem fornecer uma alternativa melhor.</p>
                
                <h4>Foco Inteligente com `:focus-visible`</h4>
                <p>Use a pseudo-classe <code>:focus-visible</code>. Ela é mais inteligente que <code>:focus</code>, pois geralmente mostra o anel de foco apenas para interações via teclado, e não com o mouse, agradando a designers e, principalmente, a usuários de teclado.</p>
                <pre><code class="language-css">/* Um indicador de foco robusto e bonito */
:focus-visible {
    outline: 3px solid #67e8f9; /* Cor ciano bem visível */
    outline-offset: 3px;
    border-radius: 4px; /* Para cantos arredondados */
}</code></pre>
                
                <h4>Gerenciando o Foco em Componentes Dinâmicos</h4>
                <p>Ao abrir um modal, por exemplo, o foco deve ser movido programaticamente para dentro dele (<code>modalElement.focus()</code>). Ao fechá-lo, o foco deve retornar ao elemento que o abriu. Isso evita que o usuário se "perca" na página.</p>
                
                <blockquote><strong>Dica Bônus:</strong> Adicione um "Skip Link" (link "pular para o conteúdo") no topo do seu `&lt;body&gt;`. Ele fica escondido até receber foco via `Tab` e permite que usuários de teclado pulem diretamente para o conteúdo principal. (Já adicionei um de exemplo nesta página!).</blockquote>
                
                <h2>Ferramentas e Próximos Passos</h2>
                <p>Incorporar a acessibilidade em seu trabalho diário eleva sua habilidade como desenvolvedor. Comece usando ferramentas para automatizar a detecção de problemas:</p>
                <ul>
                    <li><strong>axe DevTools:</strong> Extensão para navegador que escaneia a página e aponta erros de acessibilidade com sugestões de correção.</li>
                    <li><strong>Lighthouse:</strong> Ferramenta do Google Chrome DevTools que possui uma auditoria de acessibilidade.</li>
                    <li><strong>Leitores de Tela:</strong> Aprenda o básico do NVDA (Windows, gratuito) ou VoiceOver (macOS, nativo) para testar sua aplicação como um usuário real faria.</li>
                </ul>
                <p>Acessibilidade não é um destino final, mas uma jornada contínua. Cada pequeno ajuste contribui para uma experiência digital muito mais inclusiva e profissional.</p>

            </div>
        </article>
    </main>

    <footer class="bg-gray-900/50 border-t border-gray-800 mt-20">
        <div class="container mx-auto px-6 py-6 text-center text-gray-500">
            <p>&copy; 2025 Thiago Ramos. Todos os direitos reservados.</p>
        </div>
    </footer>
    
    <button id="toTopBtn" onclick="scrollToTop()" title="Voltar ao topo"
            class="p-3 rounded-full bg-cyan-600 hover:bg-cyan-700 text-white shadow-lg transition-colors">
        <i data-lucide="arrow-up" class="w-5 h-5"></i>
    </button>
    
    <script>
        lucide.createIcons();
        
        // --- Lógica para o botão "Voltar ao Topo" ---
        
        // Pega o botão
        const toTopBtn = document.getElementById("toTopBtn");

        // Mostra o botão quando o usuário rola 200px para baixo
        window.onscroll = function() {
            if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
                toTopBtn.style.display = "block";
            } else {
                toTopBtn.style.display = "none";
            }
        };

        // Função que rola a página para o topo
        function scrollToTop() {
            window.scrollTo({top: 0, behavior: 'smooth'});
        }
    </script>

    <script>
        (function() {
            const BODY = document.body;
            const PREF_KEY = 'immersion-mode';
            const PREF_TRACK = 'immersion-track';
            const PREF_VOL = 'immersion-volume';
            const PREF_MUTED = 'immersion-muted';
            const headerBtn = document.getElementById('immersion-toggle');
            let enabled = false; let autoStartPending = false; let controls; let volInput; let muteBtn; let trackLofiBtn; let trackSynthBtn;

            const synth = { ctx: null, master: null, filter: null, delay: null, fb: null, timer: null, idx: 0, track: 'synth', noise: null, lfo: null, lfoGain: null,
                ensure(){ if(this.ctx) return; const AC=window.AudioContext||window.webkitAudioContext; if(!AC) return; const ctx=new AC(); const master=ctx.createGain(); master.gain.value=Number(localStorage.getItem(PREF_VOL)||0.18); const filter=ctx.createBiquadFilter(); filter.type='lowpass'; filter.frequency.value=1200; filter.Q.value=0.7; const delay=ctx.createDelay(); delay.delayTime.value=0.34; const fb=ctx.createGain(); fb.gain.value=0.28; const noiseBuf=ctx.createBuffer(1,ctx.sampleRate*2,ctx.sampleRate); const data=noiseBuf.getChannelData(0); for(let i=0;i<data.length;i++) data[i]=(Math.random()*2-1)*0.6; const noise=ctx.createBufferSource(); noise.buffer=noiseBuf; noise.loop=true; const noiseGain=ctx.createGain(); noiseGain.gain.value=0.0; noise.connect(noiseGain).connect(filter); noise.start(); const lfo=ctx.createOscillator(); lfo.type='sine'; lfo.frequency.value=0.25; const lfoGain=ctx.createGain(); lfoGain.gain.value=0.0; lfo.connect(lfoGain).connect(master.gain); lfo.start(); filter.connect(delay); delay.connect(fb); fb.connect(delay); filter.connect(master); delay.connect(master); master.connect(ctx.destination); this.ctx=ctx; this.master=master; this.filter=filter; this.delay=delay; this.fb=fb; this.noise=noiseGain; this.lfo=lfo; this.lfoGain=lfoGain; this.setTrack(localStorage.getItem(PREF_TRACK)||'synth'); },
                midiToFreq(m){ return 440*Math.pow(2,(m-69)/12); },
                playChord(){ if(!this.ctx) return; const CHORDS=[[57,60,64,67],[55,59,62,65],[52,55,59,62],[60,64,67,71]]; const now=this.ctx.currentTime; const chord=CHORDS[this.idx++%CHORDS.length]; chord.forEach((m,i)=>{ const osc=this.ctx.createOscillator(); const env=this.ctx.createGain(); const useSine=this.track==='lofi'; osc.type=useSine?'sine':(i%2?'triangle':'sawtooth'); osc.frequency.value=this.midiToFreq(m); osc.detune.value=(Math.random()*2-1)*(useSine?4:8); env.gain.setValueAtTime(0.0001,now); env.gain.linearRampToValueAtTime(useSine?0.18:0.22,now+1.1+i*0.05); env.gain.linearRampToValueAtTime(0.0,now+3.8+i*0.08); osc.connect(env); env.connect(this.filter); osc.start(now+i*0.03); osc.stop(now+4.5); }); },
                setTrack(t){ this.track=t==='lofi'?'lofi':'synth'; if(!this.filter) return; if(this.track==='lofi'){ this.filter.frequency.setTargetAtTime(900,this.ctx.currentTime,0.2); this.noise.gain.setTargetAtTime(0.02,this.ctx.currentTime,0.5); this.lfoGain.gain.setTargetAtTime(0.02,this.ctx.currentTime,0.5);} else { this.filter.frequency.setTargetAtTime(1200,this.ctx.currentTime,0.2); this.noise.gain.setTargetAtTime(0.0,this.ctx.currentTime,0.3); this.lfoGain.gain.setTargetAtTime(0.0,this.ctx.currentTime,0.3);} },
                start(){ this.ensure(); if(!this.ctx) return; this.ctx.resume(); if(this.timer) clearInterval(this.timer); this.playChord(); this.timer=setInterval(()=>this.playChord(),4000); },
                stop(){ if(!this.ctx) return; if(this.timer){ clearInterval(this.timer); this.timer=null; } try{ this.ctx.suspend(); }catch{} }
            };

            function applyVisual(s){ BODY.classList.toggle('immersion-mode',s); headerBtn&&headerBtn.setAttribute('aria-pressed',String(s)); if(controls) controls.classList.toggle('hidden',!s); }
            function enable(){ enabled=true; localStorage.setItem(PREF_KEY,'on'); applyVisual(true); if(localStorage.getItem(PREF_MUTED)!=='on') synth.start(); }
            function disable(){ enabled=false; localStorage.setItem(PREF_KEY,'off'); applyVisual(false); synth.stop(); }
            function toggle(){ enabled?disable():enable(); }

            headerBtn&&headerBtn.addEventListener('click',toggle);
            document.addEventListener('keydown',(e)=>{ if(e.key==='m'||e.key==='M'){ const tag=(document.activeElement&&document.activeElement.tagName)||''; if(["INPUT","TEXTAREA","SELECT"].includes(tag)||(document.activeElement&&document.activeElement.isContentEditable)) return; toggle(); }});
            document.addEventListener('visibilitychange',()=>{ if(!synth.ctx) return; if(document.hidden) synth.stop(); else if(enabled && localStorage.getItem(PREF_MUTED)!=='on') synth.start(); });

            function buildControls(){ controls=document.getElementById('immersion-controls'); if(controls) return; controls=document.createElement('div'); controls.id='immersion-controls'; controls.className='hidden fixed bottom-20 right-4 md:right-6 bg-black/60 backdrop-blur-md border border-fuchsia-500/30 rounded-xl p-3 shadow-2xl text-xs text-gray-200 z-50'; controls.innerHTML=`<div class=\"flex items-center gap-2 mb-2\"><span class=\"text-fuchsia-300 font-semibold\">Imersão</span><span class=\"ml-2 text-[10px] text-gray-400\">(M alterna)</span></div><div class=\"flex items-center gap-2\"><button id=\"imm-mute\" class=\"inline-flex items-center justify-center w-8 h-8 rounded-md bg-gray-800/70 hover:bg-gray-700/70 border border-gray-700 text-gray-200\" aria-label=\"Ativar/Desativar som\"><i data-lucide=\"volume-2\" class=\"w-4 h-4\"></i></button><input id=\"imm-vol\" type=\"range\" min=\"0\" max=\"1\" step=\"0.01\" class=\"w-32 accent-fuchsia-500\" aria-label=\"Volume\"><div class=\"ml-2 inline-flex bg-gray-800/70 rounded-md border border-gray-700\"><button id=\"imm-track-lofi\" class=\"px-2 py-1 rounded-l-md\">Lo-fi</button><button id=\"imm-track-synth\" class=\"px-2 py-1 rounded-r-md\">Synth</button></div></div>`; document.body.appendChild(controls); lucide.createIcons(); volInput=controls.querySelector('#imm-vol'); muteBtn=controls.querySelector('#imm-mute'); trackLofiBtn=controls.querySelector('#imm-track-lofi'); trackSynthBtn=controls.querySelector('#imm-track-synth'); const savedVol=Number(localStorage.getItem(PREF_VOL)||0.18); volInput.value=String(savedVol); const savedTrack=localStorage.getItem(PREF_TRACK)||'synth'; setTrackButtons(savedTrack); if(localStorage.getItem(PREF_MUTED)==='on') setMutedUI(true); volInput.addEventListener('input',()=>{ const v=Number(volInput.value||0); localStorage.setItem(PREF_VOL,String(v)); synth.ensure(); if(synth.master){ synth.master.gain.value=v; } if(v>0){ setMutedUI(false); localStorage.setItem(PREF_MUTED,'off'); }}); muteBtn.addEventListener('click',()=>{ const currentlyMuted=localStorage.getItem(PREF_MUTED)==='on'; setMutedUI(!currentlyMuted); if(!currentlyMuted){ localStorage.setItem(PREF_MUTED,'on'); synth.stop(); } else { localStorage.setItem(PREF_MUTED,'off'); if(enabled) synth.start(); }}); trackLofiBtn.addEventListener('click',()=>switchTrack('lofi')); trackSynthBtn.addEventListener('click',()=>switchTrack('synth')); }
            function setMutedUI(m){ const icon=muteBtn.querySelector('i'); icon.setAttribute('data-lucide', m ? 'volume-x' : 'volume-2'); lucide.createIcons(); }
            function setTrackButtons(t){ trackLofiBtn.className='px-2 py-1 rounded-l-md '+(t==='lofi'?'bg-fuchsia-600 text-white':'text-gray-300 hover:bg-gray-700/60'); trackSynthBtn.className='px-2 py-1 rounded-r-md '+(t==='synth'?'bg-fuchsia-600 text-white':'text-gray-300 hover:bg-gray-700/60'); }
            function switchTrack(t){ localStorage.setItem(PREF_TRACK,t); synth.ensure(); synth.setTrack(t); setTrackButtons(t); }

            const saved = localStorage.getItem(PREF_KEY); buildControls(); if(saved==='on'){ enabled=true; applyVisual(true); autoStartPending=true; const kickoff=()=>{ if(!autoStartPending) return; autoStartPending=false; enable(); document.removeEventListener('pointerdown',kickoff); }; document.addEventListener('pointerdown',kickoff,{once:true}); }
        })();
    </script>
</body>
</html>
